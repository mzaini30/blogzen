{"judul":"Sistem di balik blog ini","deskripsi":"Svelte + Page JS + JSON Server","isi":"## Filosofi\n\nAku mau website yang cepat. Dan kebetulan juga lagi suka sama Svelte karena mudah, sintaksnya enak dilihat, dan bundlenya pun kecil.\n\nTerus, untuk backendnya sih maunya ya nggak usah buat lagi sih. Capek. Akhirnya, aku teringat sama JSON Server. Jadi, aku cuma perlu menyiapkan satu file `db.json` yang kemudian akan diolah oleh JSON Server menggunakan semua metode HTTP Request. Jadi, aku nggak perlu coding sistemnya lagi. Tinggal HTTP Request aja dari linknya berdasarkan routes dan param yang sudah dijelaskan di docsnya.\n\n## Bedah sistem blog\n\nBlog ini kubagi jadi dua sistem yaitu ketika user membukanya dan ketika aku yang membukanya. Jadi, bisa dibilang _ketika user membukanya_ adalah sistem yang sudah di level _production_ sedangkan yang _ketika aku membukanya_ adalah level _development_.\n\nPerbedaannya bisa digambarkan seperti tabel di bawah ini:\n\n| Development | Production |\n|---|---|\n| Menggunakan Svelte + JSON Server | Menggunakan Svelte |\n| Akses baca tulis | Akses baca |\n| Browser + Node JS | Browser |\n\n## Mengapa menggunakan Svelte?\n\n> Svelte itu **compiler**!\n\nArtinya, Svelte itu berbeda dengan framework Javascript lainnya seperti Vue, React, dan Angular.\n\n## Perbedaan sistem blog ini dengan SSG\n\nStatic site generator (SSG) itu sistemnya adalah menggabungkan file-file layout dengan file-file Markdown menjadi sebuah website utuh.\n\nTentu sangat berbeda dengan blog ini. Kalau di blog ini, basisnya bukan sekumpulan file Markdown sebagaimana SSG tapi menggunakan database yang disediakan oleh JSON Server yang tugasnya adalah mengolah file `db.json` sesuai dengan API dari [JSON Server](https://github.com/typicode/json-server). Cara menggunakan JSON Server hanyalah dengan melakukan HTTP Request berdasarkan API yang tersedia. Misalnya aja aku punya file `db.json` yang isinya:\n\n```json\n{\n\t\"postingan\": [\n\t\t{\n\t\t\t\"id\": 1,\n\t\t\t\"judul\": \"Hello\",\n\t\t\t\"isi\": \"Hello world\"\n\t\t},\n\t\t{\n\t\t\t\"id\": 2,\n\t\t\t\"judul\": \"Kedua\",\n\t\t\t\"isi\": \"Postingan kedua\"\n\t\t}\n\t]\n}\n```\n\nKalau di JSON Server, misalnya kita ingin menampilkan semua postingan, maka kita hanya perlu melakukan GET pada link `localhost:3000/postingan`. Kemudian, kalau kita ingin mendapatkan postingan pertama, kita cukup GET pada `localhost:3000/postingan/1`. Kalau kita ingin menambah artikel baru, cukup POST pada link `localhost:3000/postingan`. Kalau ingin menghapus postingan kedua, cukup DELETE pada `localhost:3000/postingan/2`. Mudah kan ya? Nah, itu semua aku jalankan di development karena memerlukan Node JS untuk menjalankan JSON Servernya.\n\n## Deploy dengan Github Action\n\nUntuk deployment blog ini, aku menggunakan Github Action, sebuah fitur dari Github untuk deployment. Tentu, membantu banget fitur ini.\n\n```yaml\nname: build svelte\n\non:\n  push:\n    branches:\n      - master\n\njobs:\n  deploy:\n    runs-on: ubuntu-18.04\n    steps:\n      - uses: actions/checkout@v2\n        with:\n          submodules: true\n\n      - name: Setup Node\n        uses: actions/setup-node@v1\n        with:\n          node-version: \"14.x\"\n\n      - name: Setup Python\n        uses: actions/setup-python@v2\n        with:\n          python-version: \"3.x\"\n\n      - name: Cache dependencies\n        uses: actions/cache@v1\n        with:\n          path: ~/.npm\n          key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}\n          restore-keys: ${{ runner.os }}-node-\n\n      - name: Clone Index\n        run: python clone-index.py\n\n      - name: Generate sitemap\n        run: python generate-sitemap.py\n\n      - name: Pecah JSON\n        run: python pecah-json.py\n\n      - name: Install\n        run: npm i\n\n      - name: Build\n        run: npm run build\n\n      - name: Deploy\n        uses: peaceiris/actions-gh-pages@v3\n        with:\n          github_token: ${{ secrets.GITHUB_TOKEN }}\n          publish_dir: ./public\n```\n\n## Clone index\n\n```python\nimport os, json\n\nos.chdir(\"public\")\nwith open(\"db.json\") as f:\n data = json.load(f)\nslug = []\nfor x in data[\"postingan\"]:\n slug.append(x[\"slug\"])\nfor x in slug:\n os.system('cp index.html ' + x + '.html')\nos.system(\"cp index.html 404.html\")\nos.system(\"cp index.html cari.html\")\n```\n\n## Generate sitemap\n\n```python\nimport os, json\n\nos.chdir(\"public\")\nwith open(\"db.json\") as f:\n\tdata = json.load(f)\nslug = []\nfor x in data[\"postingan\"]:\n\tslug.append(x[\"slug\"])\nslug.reverse()\nsitemap = '<urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\">'\nfor x in slug:\n\tsitemap += '<url><loc>https://blogzen.js.org/' + x + '</loc></url>'\nsitemap += '<url><loc>https://blogzen.js.org/</loc></url>'\nsitemap += '</urlset>'\nolah = open(\"sitemap.xml\", \"w\")\nolah.write(sitemap)\nolah.close()\n```\n\n## Pemecahan file JSON\n\n```python\nimport os, json\n\nos.chdir(\"public\")\nwith open(\"db.json\") as f:\n\tdata = json.load(f)\nslug = []\njudul = []\ndeskripsi = []\nisi = []\nfor x in data[\"postingan\"]:\n\tslug.append(x[\"slug\"])\n\tjudul.append(x[\"judul\"])\n\tdeskripsi.append(x[\"deskripsi\"])\n\tisi.append(x[\"isi\"])\n\nberanda = []\nfor (n, x) in enumerate(slug):\n\tberanda.append({\"slug\": x, \"judul\": judul[n], \"deskripsi\": deskripsi[n]})\nsimpan_beranda = open(\"beranda.json\", \"w\")\nsimpan_beranda.write(json.dumps(beranda))\nsimpan_beranda.close()\n\nfor (n, x) in enumerate(slug):\n\ttulis = open(x + '.json', 'w')\n\ttulis.write(json.dumps({\"judul\": judul[n], \"deskripsi\": deskripsi[n], \"isi\": isi[n]}))\n\ttulis.close()\n```"}